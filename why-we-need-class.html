<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/>
</ul>
<title>
我们为什么定义一个类
</title><link href="./css/style.css" rel="stylesheet" type="text/css"> </head>              <div class="container"><body>
<h1>
 我们为什么定义一个类
</h1>
<p>
大部分情况下，你拥有一个单方法类的原因是需要存储某些额外的状态来给方法使用。
</p>
<p>
使用一个内部函数或者闭包来替代单方法类通常会更优雅一些。
</p>
<h2>
 闭包的本质
</h2>
<p>
简单来讲，一个闭包就是一个函数， 只不过在函数内部带上了一个额外的变量环境。闭包关键特点就是它会记住自己被定义时的环境。
任何时候只要你碰到需要给某个函数增加额外的状态信息的问题，都可以考虑使用闭包。
</p>
<h2>
 如何在多次调用之间保存信息(类比于人的记忆功能)
</h2>
<ul>
<li>
类与对象
</li>
<li>
闭包
</li>
<li>
生成器(其栈帧存在于堆内存)
</li>
</ul>
<h2>
 为什么需要对象机制?
</h2>
<p>
《Python漫游指南》对此说得很好(<a href="https://pythonguidecn.readthedocs.io/zh/latest/writing/structure.html">https://pythonguidecn.readthedocs.io/zh/latest/writing/structure.html</a>#id10)
</p>
<pre><code>
然而，与Java不同的是，Python并没有将面向对象编程作为最主要的编程范式。
非面向 对象的Python项目(比如，使用较少甚至不使用类定义，类继承，或其它面向对象编程的 机制)
也是完全可行的。

此外在 模块 章节里曾提到，Python管理模块与命名空间的方式提供给开发者一个自然 的方式以实现抽象层的封装和分离，
这是使用面向对象最常见的原因。
因而，如果业务逻辑 没有要求，Python开发者有更多自由去选择不使用面向对象。

在一些情况下，需要避免不必要的面向对象。当我们想要将状态与功能结合起来，使用 标准类定义是有效的。
但正如函数式编程所讨论的那个问题，函数式的“变量”状态与类的 状态并不相同。

在某些架构中，典型代表是web应用，大量Python进程实例被产生以响应可能同时到达的 外部请求。
在这种情况下，在实例化对象内保持某些状态，即保持某些环境静态信息， 容易出现并发问题或竞态条件。
有时候在对象状态的初始化(通常通过 __init__() 方法实现)和在其方法中使用该状态之间，
环境发生了变化，保留的状态可能已经过时。 
举个例子，某个请求将对象加载到内存中并标记它为已读。如果同时另一个请求要删除 这个对象，
删除操作可能刚好发生在第一个请求加载完该对象之后，结果就是第一个请 求标记了一个已经被删除的对象为已读。

这些问题使我们产生一个想法：使用无状态的函数是一种更好的编程范式。
另一种建议 是尽量使用隐式上下文和副作用较小的函数与程序。
函数的隐式上下文由函数内部访问 到的所有全局变量与持久层对象组成。副作用即函数可能使其隐式上下文发生改变。
如果函数保存或删除全局变量或持久层中数据，这种行为称为副作用。

把有隐式上下文和副作用的函数与仅包含逻辑的函数(纯函数)谨慎地区分开来，会带来 以下好处：

1. 纯函数的结果是确定的：给定一个输入，输出总是固定相同。
2. 当需要重构或优化时，纯函数更易于更改或替换。
3. 纯函数更容易做单元测试：很少需要复杂的上下文配置和之后的数据清除工作。
4. 纯函数更容易操作、修饰和分发。

总之，对于某些架构而言，纯函数比类和对象在构建模块时更有效率，因为他们没有任何 上下文和副作用。
但显然在很多情况下，面向对象编程是有用甚至必要的。
例如图形桌面 应用或游戏的开发过程中，操作的元素(窗口、按钮、角色、车辆)在计算机内存里拥有相 对较长的生命周期。
</code></pre>
</div></body></html>
